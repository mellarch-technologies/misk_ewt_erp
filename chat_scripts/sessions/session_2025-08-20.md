Plan: add a left‑nav “Donations” entry that lands on a picker and routes into the filtered Donations list; note the banner/poster deferral; ensure no analyzer errors.
What I implemented
Drawer link
Added a “Donations” item in the left nav (Dashboard drawer).
It opens a simple picker screen to choose an Initiative; optional “filter list” icon lets you choose a Campaign under that Initiative.
Then navigates to the existing DonationsListScreen filtered by the chosen Initiative (and Campaign when selected).
New screen
lib/screens/donations/donations_entry_screen.dart
Lists initiatives; tap → initiative-filtered donations; tap filter icon → campaign chooser → initiative+campaign-filtered donations.
Wiring
Navigation uses a direct MaterialPageRoute from the Drawer (no new named route).
Fixed analyzer issues; current modified files show no errors.
Confirmations
Yes, a direct link to the Donations page is now in the left nav.
Milestones for the Masjid initiative are ensured by the seeder (idempotent, non-destructive).
Banner/poster features noted and deferred until after User Avatar Photo upload; current optional fields won’t block anything.
Quick test
Open app → Drawer → Donations.
Select “Masjid Project Phase 2 — Construction” → see donations filtered by that initiative.
Use the filter icon on that initiative to choose a specific campaign → see donations filtered by initiative+campaign.
Try bulk reconcile and quick actions; totals should refresh.
Next recommended step
Implement User Avatar Photo upload backend adapter (Shared Hosting or Google Drive) and wire into the existing User form Upload button, then revisit banners/posters.


Here’s the plan to take UI/UX to “industry grade,” plus confirmation on the Donations nav.
Status
Added a “Donations” item in the left nav (Drawer). It opens an Initiative picker and then the filtered Donations list. Static analyzer reports no errors in the updated files.
UI/UX upgrade plan Phase A — Design System and Theme
Tokens: color palette (primary/secondary/neutral), spacings (4/8/12/16/24), radii, shadows, elevations.
Typography: Google Fonts, clear scale for headings/body/captions; consistent sizes/weights.
AppBar/Header: small logo left, page title, user avatar action right.
Phase B — Responsive Navigation Shell
AppShell: one responsive scaffold that renders:
Drawer on desktop (existing), NavigationRail on tablet, BottomNavigationBar (footer) on mobile.
Tabs: Dashboard, Initiatives, Campaigns, Donations, Settings.
Behavior: each tab keeps its own navigation stack (nested Navigators) to preserve state; deep links still supported.
Files: widgets/app_shell.dart, widgets/app_bottom_nav.dart, update main.dart to mount AppShell and register destinations.
Phase C — Screen Polish and Patterns
Lists: card-based items with consistent padding, chips, status/colors, skeleton loaders.
Forms: section headers, helper text, correct keyboard types, compact spacing.
State views: unify empty/error/loaders (shared widgets).
Feedback: keep SnackbarHelper; add success/error icons and consistent durations.
Phase D — Accessibility and Quality
Tap targets ≥ 44px, semantics labels, focus order, high contrast, motion-safe transitions.
L10n hooks (strings centralized); RTL-safe layouts.
Phase E — Avatar Photo Upload (before banners/posters)
Implement Shared Hosting or Google Drive adapter in PhotoRepository and wire “Upload” in User form.
Optional crop/compress on-device; show preview.
Phase F — Performance and Polish
Image prefetching/caching, provider memoization, reduce jank on large lists.
Acceptance criteria
Responsive nav (Drawer/Rail/BottomNav) works across breakpoints.
Consistent look/feel and typography throughout.
Each tab preserves state; back button behavior correct.
No analyzer errors; basic smoke passes on Android/iOS/Web.
What I’ll do next (batch 1)
Scaffold AppShell with BottomNavigationBar (mobile) and keep Drawer (desktop).
Wire 5 tabs and move current routes under the shell without breaking deep links.
Apply base theme tokens and typography (non-breaking).
You can test Donations now
Drawer → Donations → pick an Initiative → filtered donations list. Use the filter icon to choose a Campaign under that Initiative.
If you want, I can proceed to implement the AppShell + bottom nav in the next batch and keep the Drawer for wide screens.


I’ll lock down what to commit vs ignore, and give you safe, versioned Git steps.
What I did
Added a robust .gitignore at the repo root to prevent committing secrets and build artifacts (Flutter/.dart_tool, build/, IDE files, Pods/ephemeral, Android local.properties, keystores, and Firebase service accounts).
Highlights:
Ignore: build/, .dart_tool/, .idea/, android/.gradle/, android/local.properties, ios/Pods/, macos/Flutter/ephemeral/
Ignore secrets: misk-edu-and-welfare-trust-*.json, serviceAccount.json, firebase-admin.json
Keep: lib/, assets/, pubspec.yaml, pubspec.lock, android/, ios/, macos/, linux/, windows/, web/, firebase/firestore.rules, test/, scripts/ (but not backup_*.json), docs/, project_log.md, WORKING_VERSION.md
What to commit (include)
Source and configs: lib/, assets/, pubspec.yaml, pubspec.lock, analysis_options.yaml, firebase/firestore.rules
Platform scaffolding: android/, ios/, macos/, linux/, windows/, web/
App code: models/, providers/, screens/, services/, widgets/
Tests: test/
Scripts (no backups/secrets): scripts/*.py etc.
Docs: README.md, project_log.md, WORKING_VERSION.md
What NOT to commit (exclude via .gitignore)
Generated/build: build/, .dart_tool/, Pods/, ephemeral/, IDE metadata (.idea/, *.iml, .vscode/)
Local env/keys: android/local.properties, any .keystore/.jks, service account JSONs (misk-edu-and-welfare-trust-.json), backup_.json
If a secret is already tracked
Remove from index and prevent future adds:
git rm --cached misk-edu-and-welfare-trust-45c246941758.json
git commit -m "chore(security): remove service account from repo"
To purge from history later, use BFG Repo-Cleaner or git filter-repo (optional).
Versioned commit and tag
Fresh repo:
git init
git add .
git status
git commit -m "chore(release): v0.10.0 pre-Phase1 — donations nav, seeders, cleanup"
git tag -a v0.10.0 -m "pre-Phase1 UI/UX + Donations nav"
git branch -M main
git remote add origin https://github.com/<org>/<repo>.git
git push -u origin main
git push origin v0.10.0
Existing repo (prefer a branch + PR):
git checkout -b chore/pre-phase1
git add .
git commit -m "chore(release): v0.10.0 pre-Phase1 — donations nav, seeders, cleanup"
git tag -a v0.10.0 -m "pre-Phase1 UI/UX + Donations nav"
git push -u origin chore/pre-phase1
git push origin v0.10.0
Notes
Keep firebase_options.dart (client config) committed; it’s not a secret.
Don’t commit the service account JSON in the repo root; it’s now ignored by .gitignore.
pubspec.lock should be committed for apps to lock dependency versions.
After you push v0.10.0, we can start Phase 1 UI/UX shell work safely.

Here’s what I just finished and how we’ll proceed with Phase 1 UI/UX.
What I changed (ready to test)
Safe Git defaults
Added .gitignore tailored for Flutter and secrets (prevents committing service accounts, build outputs, IDE files).
Donations navigation
Added a “Donations” link in the left Drawer.
New screen: lib/screens/donations/donations_entry_screen.dart (pick an Initiative, optional Campaign, then opens the filtered Donations list).
Footer nav (Phase 1 shell)
New AppShell with a BottomNavigationBar (Dashboard, Initiatives, Campaigns, Donations, Settings).
Wired AuthWrapper to show AppShell after login.
Removed temporary footer nav from DashboardScreen to avoid duplication.
Build check (modified files)
Static analyzer: no errors in main.dart, dashboard_screen.dart, donations_entry_screen.dart, donations_list_screen.dart.
Important security note
You have a service account JSON at repo root: misk-edu-and-welfare-trust-45c246941758.json. It’s ignored now, but if it was ever committed you should remove it from git history. Minimal step if tracked:
git rm --cached misk-edu-and-welfare-trust-45c246941758.json
git commit -m "chore(security): remove service account from repo"
For full history purge later, use BFG or git filter-repo.
Commit/tag this checkpoint
Suggested message and tag:
Commit: chore(release): v0.11.0 Phase1 shell + Donations nav + .gitignore
Tag: v0.11.0
Quick run (local)
flutter pub get
flutter run
Phase 1 UI/UX next (incremental)
Theme tokens and typography (Google Fonts), unify spacing/radii/shadows.
AppShell polish (active tab color, safe-area, back behavior per tab).
Lists/cards/forms: consistent padding, chips, skeleton loaders, shared empty/error views.
Keep Avatar Upload next after shell polish (Shared Hosting/Drive adapter already scaffolded).
If you confirm, I’ll proceed with Phase 1 batch: theme tokens + typography + shared state widgets, then apply to Dashboard, Initiatives, and Campaigns.

Proceeding with Phase 1 UI/UX shell: I added a professional, responsive app shell with footer navigation and wired a direct Donations entry.
What I implemented
Responsive AppShell
New widget with tabbed navigation using an IndexedStack (preserves tab state).
BottomNavigationBar on narrow screens; NavigationRail on wide screens.
Tabs: Dashboard, Initiatives, Campaigns, Donations, Settings.
AuthWrapper now shows AppShell after login (replaces the one-off Dashboard root).
Drawer + Donations entry
Kept the existing left Drawer.
Added a “Donations” item that opens a new Initiative picker:
donations_entry_screen.dart: pick an Initiative; optional Campaign filter; routes to the existing filtered Donations list.
Cleanup
Removed a temporary footer nav from DashboardScreen to avoid duplication.
Theme already uses Google Fonts (Poppins) and brand tokens; left intact for Phase 1 polish.
Quality gates
Static analyzer check on modified files (main.dart, widgets/app_shell.dart, screens/dashboard_screen.dart, donations screens): PASS. No syntax/type errors detected.
Routes/backwards compatibility: All existing named routes remain (deep links not broken).
How to try it locally
flutter pub get
flutter run
After login: use footer tabs (mobile) or side rail (desktop). Drawer also works. Tap “Donations” to open the Initiative picker, then go into the filtered Donations list.
Phase 1 next (targeted polish)
Apply tokens consistently to lists/cards/forms and unify empty/error/skeleton states.
Tighten AppBar/header styles and spacing across screens.
Fine-tune colors, radii, shadows, and typography scale for a LinkedIn-grade feel.
Then implement Avatar Photo upload adapter (Shared Hosting/Drive) and wire to the existing Upload button.
If you want, I can commit this shell as v0.11.0 (Phase1 shell + Donations nav) on your branch so you have a clean baseline before we continue with polish.


While working to commit the changes and start phase 1 token exceeded.

Plan update: Phase 1 UI/UX — Shared state views + AppBar unification (Batch 1)

What I did now
- Added shared skeleton loaders (SkeletonLine, SkeletonList) in lib/widgets/state_views.dart.
- Switched Initiatives, Campaigns, Users, Tasks, and Events list screens to use SkeletonList during loading.
- Standardized Donations empty state with shared EmptyState.
- Unified AppBar styling by relying on global AppBarTheme in Dashboard, Global Settings, and Users screens.
- Analyzer: PASS on all modified files.

Why
- Meet Resume Checklist items for consistent loading/empty/error states and unified headers.
- Reduce per-screen UI drift and speed up future polish (spacing/radii/shadows pass).

Quick smoke
- Open each list screen; while loading, skeletons appear; with no data, EmptyState shows.
- AppBars use theme colors consistently.

Next (Batch 2)
- Apply state views where missing (e.g., Roles if needed).
- Begin tokenized spacing/radii/shadows pass on common cards/forms.
- Unify remaining AppBars and header spacing.

Notes
- No new dependencies added.
- Project log updated with this batch for traceability.

Plan update: Footer nav stability and header unification (Batch 1.1)

What I did now
- Fixed AppShell flicker after login by removing explicit push to '/dashboard' from login_screen.dart; AuthWrapper now renders AppShell directly.
- Adjusted App Lock unlock flow to rely on AuthWrapper (no direct Dashboard navigation) to preserve tabs.
- Unified AppBar styling across: Users (form), Payment Settings, App Lock Settings, and App Lock screens (theme-driven headers).
- Cleaned analyzer warnings (unused imports) in the above screens.

Sanity checks
- Login → AppShell footer nav stays visible; tabs switch without flicker.
- Lock screen → unlock via PIN/biometrics returns to AppShell without route jumps.
- Analyzer on modified files: PASS (only deprecation warnings remain for RadioListTile API, noted for later).

Next
- Spacing/radii/shadows token pass on cards/forms.
- Address RadioListTile deprecation (migrate to RadioGroup) in App Lock timeout.

Phase 1 UI/UX — Back/Home Leading + Design Tokens (Batch 2)
What changed
- Nav: Added BackOrHomeButton leading to tab root screens (Initiatives, Campaigns, Donations Entry, Settings, Events & Announcements). Behavior: back when route can pop; home when at tab root switches to Dashboard via AppShell global key.
- AppShell: added global key and helper to switch tabs; AuthWrapper mounts AppShell with this key.
- Design tokens: Replaced hard-coded paddings/spacers with MiskTheme spacing across:
  - Initiatives list (and restored dynamic grid), Campaigns list
  - Donations Entry and Donations list
  - Users list and User form
  - Tasks list
  - Events & Announcements list
  - Campaign form
- Quality: Static analyzer PASS on all changed files.

Why
- Improve navigation clarity on mobile (bottom nav) and ensure consistent spacing/rhythm for an industry-grade feel.

Next
- Dashboard polish (cards/KPIs) using tokens
- Reintroduce Tasks status filter via modal selector for SDK-compat
- Migrate App Lock timeout to RadioGroup (deprecation)
- Avatar Photo upload backend (Shared Hosting/Drive) after UI polish

Suggested commit
- chore(ui): Phase 1 polish — Back/Home leading + design tokens; analyzer clean

---

[2025-08-21] Uploads Setup — Discussion Notes, Rotation, and Shipping
- Kickoff reference: Upload strategy planned on 2025-08-16; live endpoint + key shared on 2025-08-21 to finalize wiring. No secret stored in repo.
- Current state: App reads PHOTO_BACKEND, SHARED_ENDPOINT_URL, SHARED_API_KEY via dart-define; User Form uploads to users/{uid}/photos; server sample (PHP) and setup guide added under docs/integrations/.
- Key rotation (answer to “if we don’t hardcode, how to change?”): Yes, with dart-define it’s a build-time config; rotate by (1) make server accept old+new keys, (2) build/release with the new key, (3) retire old key after rollout. Future hardening: short-lived HMAC tokens to avoid app rebuilds.
- Play Store shipping (without hardcoding): Build with dart-define (see docs). Example:
  - flutter build appbundle --release --dart-define=PHOTO_BACKEND=sharedHosting --dart-define=SHARED_ENDPOINT_URL=https://uploads.erp.misk.org.in/api/upload.php --dart-define=SHARED_API_KEY=YOUR_RELEASE_KEY
- Action checklist:
  1) [Done] Wire dart-define + client dir structure.
  2) [Done] Docs + server upload.php sample.
  3) [Next] Add upload buttons to Campaign/Initiative/Event forms (module dirs).
  4) [Next] Settings tile for backend info and test ping.
  5) [Next] Optional HMAC/time-window tokens + CI secret injection.
